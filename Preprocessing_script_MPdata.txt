#already removed nextera adapters and trimmed 10 bases off end of each read using cutadapt.  

#code to run bbmap - filtering out possible contaminants.
/home/ubuntu/HvGen/src/bbmap/bbsplit.sh in1=./HvGen3/HvINT_MP_cutadapt_out.1.fastq in2=./HvGen3/HvINT_MP_cutadapt_out.2.fastq ref=./HvGen/symbionts_and_contaminants/CimexLectularisWolbachia.fasta,./HvGen/symbionts_and_contaminants/DmelWolbachia.fasta,./HvGen/symbionts_and_contaminants/DsimWolbachia.fasta,./HvGen/symbionts_and_contaminants/PhiX.fasta,./HvGen/symbionts_and/contaminants/HzSNPV_genome.fasta,./HvGen/symbionts_and_contaminants/HvAscoVirus_genome.fa,./HvGen/symbionts_and_contaminants/partial_Hv_mtDNA.fasta basename=./HvGen3/out1_%.fq outu1=./HvGen3/MP_Run1Forward.clean.fq outu2=./HvGen3/MP_Run1Reverse.clean.fq

#Stand-alone error correction using SOAPec version 2.01 (this was built into my earlier soap assembly).

/home/ubuntu/HvGen/src/SOAPec_v2.01/bin/KmerFreq_AR -k 17 -s 0 -t 16 -p MP_HvCorrected /home/ubuntu/HvGen3/ReadsFileList.txt

/home/ubuntu/HvGen/src/SOAPec_v2.01/bin/Corrector_AR -r 50 -t 16 /home/ubuntu/HvGen3/MP_HvCorrected.freq.cz /home/ubuntu/HvGen3/MP_HvCorrected.freq.cz.len ReadsFileList.txt


#want to look at new kmer freq spectrum following filtering and error correction. this will check using same kmer length as was used for error correction.

cd /home/ubuntu/HvGen/src/jellyfish-2.2.3/bin
./jellyfish count <(zcat /home/ubuntu/HvGen2/Run2Forward.clean.fq.gz.cor.pair_1.fq.gz) <(zcat /home/ubuntu/HvGen2/Run2Reverse.clean.fq.gz.cor.pair_2.fq.gz) -m 17 -s 100M -t 16

./jellyfish histo mer_counts.jf
